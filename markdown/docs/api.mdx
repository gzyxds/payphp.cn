---
# é¡µé¢å…ƒæ•°æ®é…ç½®
title: "APIæ¥å£ä½¿ç”¨" # é¡µé¢æ ‡é¢˜
description: "PayPHPç æ”¯ä»˜ç³»ç»ŸAPIæ¥å£ä½¿ç”¨æŒ‡å—" # é¡µé¢æè¿°
date: "2024-01-23" # æœ€åæ›´æ–°æ—¥æœŸ
category: "ä½¿ç”¨æŒ‡å—" # æ–‡æ¡£åˆ†ç±»
subcategory: "é«˜çº§åŠŸèƒ½" # æ–‡æ¡£å­åˆ†ç±»
order: 1 # æ–‡æ¡£æ’åº
icon: "ğŸ”Œ" # æ–‡æ¡£å›¾æ ‡
---

# APIæ¥å£ä½¿ç”¨æŒ‡å—

PayPHP ç æ”¯ä»˜ç³»ç»Ÿæä¾›äº†å®Œå–„çš„ API æ¥å£ï¼Œæ–¹ä¾¿å•†æˆ·ç³»ç»Ÿä¸æ”¯ä»˜ç³»ç»Ÿè¿›è¡Œå¯¹æ¥ã€‚æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç» API æ¥å£çš„ä½¿ç”¨æ–¹æ³•å’Œæ³¨æ„äº‹é¡¹ã€‚

## API æ¦‚è¿°

### æ¥å£è§„èŒƒ

PayPHP ç æ”¯ä»˜ç³»ç»Ÿçš„ API æ¥å£é‡‡ç”¨ RESTful é£æ ¼è®¾è®¡ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- **è¯·æ±‚æ–¹å¼**ï¼šä¸»è¦ä½¿ç”¨ POST æ–¹æ³•
- **æ•°æ®æ ¼å¼**ï¼šè¯·æ±‚å’Œå“åº”å‡ä½¿ç”¨ JSON æ ¼å¼
- **å­—ç¬¦ç¼–ç **ï¼šç»Ÿä¸€ä½¿ç”¨ UTF-8 ç¼–ç 
- **å®‰å…¨è®¤è¯**ï¼šé‡‡ç”¨ç­¾åæœºåˆ¶ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§
- **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€çš„é”™è¯¯ç å’Œé”™è¯¯ä¿¡æ¯æ ¼å¼

### æ¥å£åœ°å€

API æ¥å£çš„åŸºç¡€åœ°å€ä¸ºï¼š

```
https://æ‚¨çš„åŸŸå/api/v1
```

ä¾‹å¦‚ï¼Œåˆ›å»ºè®¢å•çš„æ¥å£åœ°å€ä¸ºï¼š

```
https://æ‚¨çš„åŸŸå/api/v1/order/create
```

### æ¥å£è®¤è¯

æ‰€æœ‰ API è¯·æ±‚éƒ½éœ€è¦è¿›è¡Œç­¾åè®¤è¯ï¼Œç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§å’Œå®‰å…¨æ€§ã€‚è®¤è¯ä¿¡æ¯åŒ…æ‹¬ï¼š

- **app_id**ï¼šå•†æˆ· IDï¼Œåœ¨å•†æˆ·åå°è·å–
- **timestamp**ï¼šè¯·æ±‚æ—¶é—´æˆ³ï¼Œç²¾ç¡®åˆ°ç§’
- **nonce_str**ï¼šéšæœºå­—ç¬¦ä¸²ï¼Œç”¨äºé˜²æ­¢é‡æ”¾æ”»å‡»
- **sign**ï¼šè¯·æ±‚ç­¾åï¼Œæ ¹æ®è¯·æ±‚å‚æ•°å’Œå•†æˆ·å¯†é’¥ç”Ÿæˆ

## ç­¾åç®—æ³•

### ç­¾åç”Ÿæˆæ­¥éª¤

1. å°†æ‰€æœ‰è¯·æ±‚å‚æ•°ï¼ˆé™¤ sign å¤–ï¼‰æŒ‰ç…§å‚æ•°å ASCII ç ä»å°åˆ°å¤§æ’åº
2. å°†æ’åºåçš„å‚æ•°æŒ‰ç…§ "å‚æ•°å=å‚æ•°å€¼" çš„æ ¼å¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ï¼Œå‚æ•°ä¹‹é—´ç”¨ "&" è¿æ¥
3. åœ¨æ‹¼æ¥å¥½çš„å­—ç¬¦ä¸²æœ«å°¾è¿½åŠ  "&key=å•†æˆ·å¯†é’¥"
4. å¯¹æœ€ç»ˆçš„å­—ç¬¦ä¸²è¿›è¡Œ MD5 åŠ å¯†ï¼Œå¹¶è½¬ä¸ºå¤§å†™

### ç­¾åç¤ºä¾‹

å‡è®¾è¯·æ±‚å‚æ•°å¦‚ä¸‹ï¼š

```json
{
  "app_id": "10001",
  "out_trade_no": "202401230001",
  "total_amount": "100.00",
  "subject": "æµ‹è¯•å•†å“",
  "timestamp": "1611123456",
  "nonce_str": "abcdef123456"
}
```

å•†æˆ·å¯†é’¥ä¸ºï¼š`a5f3f71efb96fe68b1b8f3791a1e2e1d`

ç­¾åç”Ÿæˆè¿‡ç¨‹ï¼š

1. å‚æ•°æ’åºï¼šapp_idã€nonce_strã€out_trade_noã€subjectã€timestampã€total_amount
2. æ‹¼æ¥å­—ç¬¦ä¸²ï¼š`app_id=10001&nonce_str=abcdef123456&out_trade_no=202401230001&subject=æµ‹è¯•å•†å“&timestamp=1611123456&total_amount=100.00&key=a5f3f71efb96fe68b1b8f3791a1e2e1d`
3. MD5 åŠ å¯†å¹¶è½¬å¤§å†™ï¼š`A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6`

æœ€ç»ˆè¯·æ±‚å‚æ•°ï¼š

```json
{
  "app_id": "10001",
  "out_trade_no": "202401230001",
  "total_amount": "100.00",
  "subject": "æµ‹è¯•å•†å“",
  "timestamp": "1611123456",
  "nonce_str": "abcdef123456",
  "sign": "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6"
}
```

## æ ¸å¿ƒæ¥å£

### 1. åˆ›å»ºè®¢å•

#### æ¥å£è¯´æ˜

è¯¥æ¥å£ç”¨äºåˆ›å»ºæ”¯ä»˜è®¢å•ï¼Œè·å–æ”¯ä»˜é“¾æ¥æˆ–äºŒç»´ç ã€‚

#### è¯·æ±‚åœ°å€

```
POST /api/v1/order/create
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|-------|------|-----|------|
| app_id | String | æ˜¯ | å•†æˆ·ID |
| out_trade_no | String | æ˜¯ | å•†æˆ·è®¢å•å·ï¼Œéœ€ä¿è¯å”¯ä¸€æ€§ |
| total_amount | String | æ˜¯ | è®¢å•é‡‘é¢ï¼Œå•ä½å…ƒï¼Œç²¾ç¡®åˆ°å°æ•°ç‚¹åä¸¤ä½ |
| subject | String | æ˜¯ | å•†å“æ ‡é¢˜ |
| body | String | å¦ | å•†å“æè¿° |
| notify_url | String | æ˜¯ | æ”¯ä»˜ç»“æœé€šçŸ¥åœ°å€ |
| return_url | String | å¦ | æ”¯ä»˜å®Œæˆåè·³è½¬åœ°å€ |
| payment_method | String | å¦ | æ”¯ä»˜æ–¹å¼ï¼Œä¸ä¼ åˆ™æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨æ”¯ä»˜æ–¹å¼ |
| expire_time | Integer | å¦ | è®¢å•æœ‰æ•ˆæœŸï¼Œå•ä½åˆ†é’Ÿï¼Œé»˜è®¤30åˆ†é’Ÿ |
| timestamp | String | æ˜¯ | è¯·æ±‚æ—¶é—´æˆ³ |
| nonce_str | String | æ˜¯ | éšæœºå­—ç¬¦ä¸² |
| sign | String | æ˜¯ | è¯·æ±‚ç­¾å |

#### è¯·æ±‚ç¤ºä¾‹

```json
{
  "app_id": "10001",
  "out_trade_no": "202401230001",
  "total_amount": "100.00",
  "subject": "æµ‹è¯•å•†å“",
  "body": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å•†å“",
  "notify_url": "https://www.example.com/notify",
  "return_url": "https://www.example.com/return",
  "payment_method": "wechat",
  "expire_time": 30,
  "timestamp": "1611123456",
  "nonce_str": "abcdef123456",
  "sign": "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6"
}
```

#### å“åº”å‚æ•°

| å‚æ•°å | ç±»å‹ | æè¿° |
|-------|------|-----|
| code | Integer | çŠ¶æ€ç ï¼Œ0è¡¨ç¤ºæˆåŠŸï¼Œé0è¡¨ç¤ºå¤±è´¥ |
| message | String | çŠ¶æ€æè¿° |
| data | Object | å“åº”æ•°æ® |
| data.order_no | String | ç³»ç»Ÿè®¢å•å· |
| data.out_trade_no | String | å•†æˆ·è®¢å•å· |
| data.total_amount | String | è®¢å•é‡‘é¢ |
| data.payment_url | String | æ”¯ä»˜é“¾æ¥ |
| data.qrcode_url | String | äºŒç»´ç å›¾ç‰‡URL |
| data.qrcode_data | String | äºŒç»´ç å†…å®¹ |
| data.expire_time | String | è®¢å•è¿‡æœŸæ—¶é—´ |

#### å“åº”ç¤ºä¾‹

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "order_no": "P202401230001",
    "out_trade_no": "202401230001",
    "total_amount": "100.00",
    "payment_url": "https://pay.example.com/pay/P202401230001",
    "qrcode_url": "https://pay.example.com/qrcode/P202401230001",
    "qrcode_data": "https://pay.example.com/pay/P202401230001",
    "expire_time": "2024-01-23 12:30:00"
  }
}
```

### 2. æŸ¥è¯¢è®¢å•

#### æ¥å£è¯´æ˜

è¯¥æ¥å£ç”¨äºæŸ¥è¯¢è®¢å•çŠ¶æ€ã€‚

#### è¯·æ±‚åœ°å€

```
POST /api/v1/order/query
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|-------|------|-----|------|
| app_id | String | æ˜¯ | å•†æˆ·ID |
| order_no | String | å¦ | ç³»ç»Ÿè®¢å•å·ï¼Œä¸å•†æˆ·è®¢å•å·äºŒé€‰ä¸€ |
| out_trade_no | String | å¦ | å•†æˆ·è®¢å•å·ï¼Œä¸ç³»ç»Ÿè®¢å•å·äºŒé€‰ä¸€ |
| timestamp | String | æ˜¯ | è¯·æ±‚æ—¶é—´æˆ³ |
| nonce_str | String | æ˜¯ | éšæœºå­—ç¬¦ä¸² |
| sign | String | æ˜¯ | è¯·æ±‚ç­¾å |

#### è¯·æ±‚ç¤ºä¾‹

```json
{
  "app_id": "10001",
  "out_trade_no": "202401230001",
  "timestamp": "1611123456",
  "nonce_str": "abcdef123456",
  "sign": "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6"
}
```

#### å“åº”å‚æ•°

| å‚æ•°å | ç±»å‹ | æè¿° |
|-------|------|-----|
| code | Integer | çŠ¶æ€ç ï¼Œ0è¡¨ç¤ºæˆåŠŸï¼Œé0è¡¨ç¤ºå¤±è´¥ |
| message | String | çŠ¶æ€æè¿° |
| data | Object | å“åº”æ•°æ® |
| data.order_no | String | ç³»ç»Ÿè®¢å•å· |
| data.out_trade_no | String | å•†æˆ·è®¢å•å· |
| data.total_amount | String | è®¢å•é‡‘é¢ |
| data.status | Integer | è®¢å•çŠ¶æ€ï¼š0-å¾…æ”¯ä»˜ï¼Œ1-æ”¯ä»˜æˆåŠŸï¼Œ2-æ”¯ä»˜å¤±è´¥ï¼Œ3-å·²å…³é—­ï¼Œ4-å·²é€€æ¬¾ |
| data.payment_method | String | æ”¯ä»˜æ–¹å¼ |
| data.trade_no | String | æ”¯ä»˜å¹³å°äº¤æ˜“å· |
| data.pay_time | String | æ”¯ä»˜æ—¶é—´ |
| data.create_time | String | åˆ›å»ºæ—¶é—´ |

#### å“åº”ç¤ºä¾‹

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "order_no": "P202401230001",
    "out_trade_no": "202401230001",
    "total_amount": "100.00",
    "status": 1,
    "payment_method": "wechat",
    "trade_no": "4200001234202401231234567890",
    "pay_time": "2024-01-23 12:15:30",
    "create_time": "2024-01-23 12:00:00"
  }
}
```

### 3. å…³é—­è®¢å•

#### æ¥å£è¯´æ˜

è¯¥æ¥å£ç”¨äºå…³é—­æœªæ”¯ä»˜çš„è®¢å•ã€‚

#### è¯·æ±‚åœ°å€

```
POST /api/v1/order/close
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|-------|------|-----|------|
| app_id | String | æ˜¯ | å•†æˆ·ID |
| order_no | String | å¦ | ç³»ç»Ÿè®¢å•å·ï¼Œä¸å•†æˆ·è®¢å•å·äºŒé€‰ä¸€ |
| out_trade_no | String | å¦ | å•†æˆ·è®¢å•å·ï¼Œä¸ç³»ç»Ÿè®¢å•å·äºŒé€‰ä¸€ |
| timestamp | String | æ˜¯ | è¯·æ±‚æ—¶é—´æˆ³ |
| nonce_str | String | æ˜¯ | éšæœºå­—ç¬¦ä¸² |
| sign | String | æ˜¯ | è¯·æ±‚ç­¾å |

#### è¯·æ±‚ç¤ºä¾‹

```json
{
  "app_id": "10001",
  "out_trade_no": "202401230001",
  "timestamp": "1611123456",
  "nonce_str": "abcdef123456",
  "sign": "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6"
}
```

#### å“åº”å‚æ•°

| å‚æ•°å | ç±»å‹ | æè¿° |
|-------|------|-----|
| code | Integer | çŠ¶æ€ç ï¼Œ0è¡¨ç¤ºæˆåŠŸï¼Œé0è¡¨ç¤ºå¤±è´¥ |
| message | String | çŠ¶æ€æè¿° |
| data | Object | å“åº”æ•°æ® |
| data.order_no | String | ç³»ç»Ÿè®¢å•å· |
| data.out_trade_no | String | å•†æˆ·è®¢å•å· |
| data.status | Integer | è®¢å•çŠ¶æ€ï¼š3-å·²å…³é—­ |

#### å“åº”ç¤ºä¾‹

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "order_no": "P202401230001",
    "out_trade_no": "202401230001",
    "status": 3
  }
}
```

### 4. ç”³è¯·é€€æ¬¾

#### æ¥å£è¯´æ˜

è¯¥æ¥å£ç”¨äºå¯¹å·²æ”¯ä»˜çš„è®¢å•ç”³è¯·é€€æ¬¾ã€‚

#### è¯·æ±‚åœ°å€

```
POST /api/v1/refund/apply
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|-------|------|-----|------|
| app_id | String | æ˜¯ | å•†æˆ·ID |
| order_no | String | å¦ | ç³»ç»Ÿè®¢å•å·ï¼Œä¸å•†æˆ·è®¢å•å·äºŒé€‰ä¸€ |
| out_trade_no | String | å¦ | å•†æˆ·è®¢å•å·ï¼Œä¸ç³»ç»Ÿè®¢å•å·äºŒé€‰ä¸€ |
| out_refund_no | String | æ˜¯ | å•†æˆ·é€€æ¬¾å•å·ï¼Œéœ€ä¿è¯å”¯ä¸€æ€§ |
| refund_amount | String | æ˜¯ | é€€æ¬¾é‡‘é¢ï¼Œä¸èƒ½å¤§äºè®¢å•é‡‘é¢ |
| refund_reason | String | å¦ | é€€æ¬¾åŸå›  |
| notify_url | String | å¦ | é€€æ¬¾ç»“æœé€šçŸ¥åœ°å€ |
| timestamp | String | æ˜¯ | è¯·æ±‚æ—¶é—´æˆ³ |
| nonce_str | String | æ˜¯ | éšæœºå­—ç¬¦ä¸² |
| sign | String | æ˜¯ | è¯·æ±‚ç­¾å |

#### è¯·æ±‚ç¤ºä¾‹

```json
{
  "app_id": "10001",
  "out_trade_no": "202401230001",
  "out_refund_no": "R202401230001",
  "refund_amount": "100.00",
  "refund_reason": "å•†å“è´¨é‡é—®é¢˜",
  "notify_url": "https://www.example.com/refund_notify",
  "timestamp": "1611123456",
  "nonce_str": "abcdef123456",
  "sign": "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6"
}
```

#### å“åº”å‚æ•°

| å‚æ•°å | ç±»å‹ | æè¿° |
|-------|------|-----|
| code | Integer | çŠ¶æ€ç ï¼Œ0è¡¨ç¤ºæˆåŠŸï¼Œé0è¡¨ç¤ºå¤±è´¥ |
| message | String | çŠ¶æ€æè¿° |
| data | Object | å“åº”æ•°æ® |
| data.refund_no | String | ç³»ç»Ÿé€€æ¬¾å•å· |
| data.out_refund_no | String | å•†æˆ·é€€æ¬¾å•å· |
| data.order_no | String | ç³»ç»Ÿè®¢å•å· |
| data.out_trade_no | String | å•†æˆ·è®¢å•å· |
| data.refund_amount | String | é€€æ¬¾é‡‘é¢ |
| data.status | Integer | é€€æ¬¾çŠ¶æ€ï¼š0-å¤„ç†ä¸­ï¼Œ1-é€€æ¬¾æˆåŠŸï¼Œ2-é€€æ¬¾å¤±è´¥ |

#### å“åº”ç¤ºä¾‹

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "refund_no": "R202401230001",
    "out_refund_no": "R202401230001",
    "order_no": "P202401230001",
    "out_trade_no": "202401230001",
    "refund_amount": "100.00",
    "status": 0
  }
}
```

### 5. æŸ¥è¯¢é€€æ¬¾

#### æ¥å£è¯´æ˜

è¯¥æ¥å£ç”¨äºæŸ¥è¯¢é€€æ¬¾çŠ¶æ€ã€‚

#### è¯·æ±‚åœ°å€

```
POST /api/v1/refund/query
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | æè¿° |
|-------|------|-----|------|
| app_id | String | æ˜¯ | å•†æˆ·ID |
| refund_no | String | å¦ | ç³»ç»Ÿé€€æ¬¾å•å·ï¼Œä¸å•†æˆ·é€€æ¬¾å•å·äºŒé€‰ä¸€ |
| out_refund_no | String | å¦ | å•†æˆ·é€€æ¬¾å•å·ï¼Œä¸ç³»ç»Ÿé€€æ¬¾å•å·äºŒé€‰ä¸€ |
| timestamp | String | æ˜¯ | è¯·æ±‚æ—¶é—´æˆ³ |
| nonce_str | String | æ˜¯ | éšæœºå­—ç¬¦ä¸² |
| sign | String | æ˜¯ | è¯·æ±‚ç­¾å |

#### è¯·æ±‚ç¤ºä¾‹

```json
{
  "app_id": "10001",
  "out_refund_no": "R202401230001",
  "timestamp": "1611123456",
  "nonce_str": "abcdef123456",
  "sign": "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6"
}
```

#### å“åº”å‚æ•°

| å‚æ•°å | ç±»å‹ | æè¿° |
|-------|------|-----|
| code | Integer | çŠ¶æ€ç ï¼Œ0è¡¨ç¤ºæˆåŠŸï¼Œé0è¡¨ç¤ºå¤±è´¥ |
| message | String | çŠ¶æ€æè¿° |
| data | Object | å“åº”æ•°æ® |
| data.refund_no | String | ç³»ç»Ÿé€€æ¬¾å•å· |
| data.out_refund_no | String | å•†æˆ·é€€æ¬¾å•å· |
| data.order_no | String | ç³»ç»Ÿè®¢å•å· |
| data.out_trade_no | String | å•†æˆ·è®¢å•å· |
| data.refund_amount | String | é€€æ¬¾é‡‘é¢ |
| data.status | Integer | é€€æ¬¾çŠ¶æ€ï¼š0-å¤„ç†ä¸­ï¼Œ1-é€€æ¬¾æˆåŠŸï¼Œ2-é€€æ¬¾å¤±è´¥ |
| data.refund_time | String | é€€æ¬¾æ—¶é—´ |
| data.create_time | String | åˆ›å»ºæ—¶é—´ |

#### å“åº”ç¤ºä¾‹

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "refund_no": "R202401230001",
    "out_refund_no": "R202401230001",
    "order_no": "P202401230001",
    "out_trade_no": "202401230001",
    "refund_amount": "100.00",
    "status": 1,
    "refund_time": "2024-01-23 14:30:00",
    "create_time": "2024-01-23 14:00:00"
  }
}
```

## é€šçŸ¥æ¥å£

### æ”¯ä»˜ç»“æœé€šçŸ¥

#### é€šçŸ¥è¯´æ˜

å½“è®¢å•æ”¯ä»˜æˆåŠŸåï¼Œç³»ç»Ÿä¼šå‘å•†æˆ·æä¾›çš„ notify_url å‘é€æ”¯ä»˜ç»“æœé€šçŸ¥ã€‚

#### é€šçŸ¥æ–¹å¼

- è¯·æ±‚æ–¹å¼ï¼šPOST
- æ•°æ®æ ¼å¼ï¼šJSON
- å­—ç¬¦ç¼–ç ï¼šUTF-8

#### é€šçŸ¥å‚æ•°

| å‚æ•°å | ç±»å‹ | æè¿° |
|-------|------|-----|
| app_id | String | å•†æˆ·ID |
| order_no | String | ç³»ç»Ÿè®¢å•å· |
| out_trade_no | String | å•†æˆ·è®¢å•å· |
| total_amount | String | è®¢å•é‡‘é¢ |
| status | Integer | è®¢å•çŠ¶æ€ï¼š1-æ”¯ä»˜æˆåŠŸ |
| payment_method | String | æ”¯ä»˜æ–¹å¼ |
| trade_no | String | æ”¯ä»˜å¹³å°äº¤æ˜“å· |
| pay_time | String | æ”¯ä»˜æ—¶é—´ |
| timestamp | String | é€šçŸ¥æ—¶é—´æˆ³ |
| nonce_str | String | éšæœºå­—ç¬¦ä¸² |
| sign | String | é€šçŸ¥ç­¾å |

#### é€šçŸ¥ç¤ºä¾‹

```json
{
  "app_id": "10001",
  "order_no": "P202401230001",
  "out_trade_no": "202401230001",
  "total_amount": "100.00",
  "status": 1,
  "payment_method": "wechat",
  "trade_no": "4200001234202401231234567890",
  "pay_time": "2024-01-23 12:15:30",
  "timestamp": "1611123456",
  "nonce_str": "abcdef123456",
  "sign": "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6"
}
```

#### å“åº”è¦æ±‚

å•†æˆ·ç³»ç»Ÿæ¥æ”¶åˆ°é€šçŸ¥åï¼Œéœ€è¦è¿”å›ä»¥ä¸‹æ ¼å¼çš„å“åº”ï¼š

```json
{
  "code": 0,
  "message": "success"
}
```

å¦‚æœç³»ç»Ÿæœªæ”¶åˆ°æ­£ç¡®çš„å“åº”ï¼Œå°†æŒ‰ç…§ä¸€å®šçš„æ—¶é—´é—´éš”è¿›è¡Œé‡è¯•ï¼Œé‡è¯•æ¬¡æ•°å’Œé—´éš”å¯åœ¨åå°é…ç½®ã€‚

### é€€æ¬¾ç»“æœé€šçŸ¥

#### é€šçŸ¥è¯´æ˜

å½“é€€æ¬¾å¤„ç†å®Œæˆåï¼Œç³»ç»Ÿä¼šå‘å•†æˆ·æä¾›çš„é€€æ¬¾é€šçŸ¥åœ°å€å‘é€é€€æ¬¾ç»“æœé€šçŸ¥ã€‚

#### é€šçŸ¥æ–¹å¼

- è¯·æ±‚æ–¹å¼ï¼šPOST
- æ•°æ®æ ¼å¼ï¼šJSON
- å­—ç¬¦ç¼–ç ï¼šUTF-8

#### é€šçŸ¥å‚æ•°

| å‚æ•°å | ç±»å‹ | æè¿° |
|-------|------|-----|
| app_id | String | å•†æˆ·ID |
| refund_no | String | ç³»ç»Ÿé€€æ¬¾å•å· |
| out_refund_no | String | å•†æˆ·é€€æ¬¾å•å· |
| order_no | String | ç³»ç»Ÿè®¢å•å· |
| out_trade_no | String | å•†æˆ·è®¢å•å· |
| refund_amount | String | é€€æ¬¾é‡‘é¢ |
| status | Integer | é€€æ¬¾çŠ¶æ€ï¼š1-é€€æ¬¾æˆåŠŸï¼Œ2-é€€æ¬¾å¤±è´¥ |
| refund_time | String | é€€æ¬¾æ—¶é—´ |
| timestamp | String | é€šçŸ¥æ—¶é—´æˆ³ |
| nonce_str | String | éšæœºå­—ç¬¦ä¸² |
| sign | String | é€šçŸ¥ç­¾å |

#### é€šçŸ¥ç¤ºä¾‹

```json
{
  "app_id": "10001",
  "refund_no": "R202401230001",
  "out_refund_no": "R202401230001",
  "order_no": "P202401230001",
  "out_trade_no": "202401230001",
  "refund_amount": "100.00",
  "status": 1,
  "refund_time": "2024-01-23 14:30:00",
  "timestamp": "1611123456",
  "nonce_str": "abcdef123456",
  "sign": "A1B2C3D4E5F6G7H8I9J0K1L2M3N4O5P6"
}
```

#### å“åº”è¦æ±‚

å•†æˆ·ç³»ç»Ÿæ¥æ”¶åˆ°é€šçŸ¥åï¼Œéœ€è¦è¿”å›ä»¥ä¸‹æ ¼å¼çš„å“åº”ï¼š

```json
{
  "code": 0,
  "message": "success"
}
```

## é”™è¯¯ç è¯´æ˜

| é”™è¯¯ç  | æè¿° | è§£å†³æ–¹æ¡ˆ |
|-------|------|---------|
| 0 | æˆåŠŸ | - |
| 1001 | å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•°æ˜¯å¦å®Œæ•´ã€æ ¼å¼æ˜¯å¦æ­£ç¡® |
| 1002 | ç­¾åé”™è¯¯ | æ£€æŸ¥ç­¾åç®—æ³•å’Œå•†æˆ·å¯†é’¥æ˜¯å¦æ­£ç¡® |
| 1003 | å•†æˆ·ä¸å­˜åœ¨ | æ£€æŸ¥å•†æˆ·IDæ˜¯å¦æ­£ç¡® |
| 1004 | å•†æˆ·å·²ç¦ç”¨ | è”ç³»ç®¡ç†å‘˜å¤„ç† |
| 2001 | è®¢å•ä¸å­˜åœ¨ | æ£€æŸ¥è®¢å•å·æ˜¯å¦æ­£ç¡® |
| 2002 | è®¢å•å·²æ”¯ä»˜ | ä¸èƒ½é‡å¤æ”¯ä»˜ï¼Œå¯æŸ¥è¯¢è®¢å•çŠ¶æ€ |
| 2003 | è®¢å•å·²å…³é—­ | è®¢å•å·²å…³é—­ï¼Œéœ€è¦é‡æ–°åˆ›å»ºè®¢å• |
| 2004 | è®¢å•å·²è¿‡æœŸ | è®¢å•å·²è¿‡æœŸï¼Œéœ€è¦é‡æ–°åˆ›å»ºè®¢å• |
| 3001 | æ”¯ä»˜æ¸ é“é”™è¯¯ | æ£€æŸ¥æ”¯ä»˜æ¸ é“å‚æ•°æ˜¯å¦æ­£ç¡® |
| 3002 | æ”¯ä»˜æ¸ é“æœªå¼€é€š | è”ç³»ç®¡ç†å‘˜å¼€é€šç›¸åº”æ”¯ä»˜æ¸ é“ |
| 4001 | é€€æ¬¾é‡‘é¢é”™è¯¯ | æ£€æŸ¥é€€æ¬¾é‡‘é¢æ˜¯å¦æ­£ç¡®ï¼Œä¸èƒ½å¤§äºè®¢å•é‡‘é¢ |
| 4002 | è®¢å•æœªæ”¯ä»˜ï¼Œä¸èƒ½é€€æ¬¾ | ç¡®è®¤è®¢å•å·²æ”¯ä»˜åå†ç”³è¯·é€€æ¬¾ |
| 4003 | é€€æ¬¾å•ä¸å­˜åœ¨ | æ£€æŸ¥é€€æ¬¾å•å·æ˜¯å¦æ­£ç¡® |
| 9999 | ç³»ç»Ÿé”™è¯¯ | è”ç³»æŠ€æœ¯æ”¯æŒå¤„ç† |

## SDK ä½¿ç”¨

ä¸ºäº†æ–¹ä¾¿å•†æˆ·å¯¹æ¥ï¼ŒPayPHP ç æ”¯ä»˜ç³»ç»Ÿæä¾›äº†å¤šç§è¯­è¨€çš„ SDKã€‚

### PHP SDK

#### å®‰è£…

ä½¿ç”¨ Composer å®‰è£…ï¼š

```bash
composer require payphp/sdk
```

#### åˆå§‹åŒ–

```php
<?php
require 'vendor/autoload.php';

use PayPHP\SDK\Client;

$config = [
    'app_id' => '10001',
    'app_key' => 'a5f3f71efb96fe68b1b8f3791a1e2e1d',
    'api_url' => 'https://æ‚¨çš„åŸŸå/api/v1',
];

$client = new Client($config);
```

#### åˆ›å»ºè®¢å•

```php
<?php
$params = [
    'out_trade_no' => '202401230001',
    'total_amount' => '100.00',
    'subject' => 'æµ‹è¯•å•†å“',
    'body' => 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å•†å“',
    'notify_url' => 'https://www.example.com/notify',
    'return_url' => 'https://www.example.com/return',
    'payment_method' => 'wechat',
    'expire_time' => 30,
];

$result = $client->createOrder($params);
print_r($result);
```

#### æŸ¥è¯¢è®¢å•

```php
<?php
$result = $client->queryOrder([
    'out_trade_no' => '202401230001',
]);
print_r($result);
```

#### å…³é—­è®¢å•

```php
<?php
$result = $client->closeOrder([
    'out_trade_no' => '202401230001',
]);
print_r($result);
```

#### ç”³è¯·é€€æ¬¾

```php
<?php
$result = $client->applyRefund([
    'out_trade_no' => '202401230001',
    'out_refund_no' => 'R202401230001',
    'refund_amount' => '100.00',
    'refund_reason' => 'å•†å“è´¨é‡é—®é¢˜',
]);
print_r($result);
```

#### æŸ¥è¯¢é€€æ¬¾

```php
<?php
$result = $client->queryRefund([
    'out_refund_no' => 'R202401230001',
]);
print_r($result);
```

#### éªŒè¯é€šçŸ¥

```php
<?php
$notifyData = $_POST; // è·å–é€šçŸ¥æ•°æ®
$isValid = $client->verifyNotify($notifyData);

if ($isValid) {
    // å¤„ç†é€šçŸ¥é€»è¾‘
    echo json_encode(['code' => 0, 'message' => 'success']);
} else {
    echo json_encode(['code' => 1002, 'message' => 'sign error']);
}
```

### Node.js SDK

#### å®‰è£…

```bash
npm install payphp-sdk
```

#### åˆå§‹åŒ–

```javascript
const PayPHP = require('payphp-sdk');

const client = new PayPHP.Client({
  appId: '10001',
  appKey: 'a5f3f71efb96fe68b1b8f3791a1e2e1d',
  apiUrl: 'https://æ‚¨çš„åŸŸå/api/v1',
});
```

#### åˆ›å»ºè®¢å•

```javascript
const params = {
  outTradeNo: '202401230001',
  totalAmount: '100.00',
  subject: 'æµ‹è¯•å•†å“',
  body: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å•†å“',
  notifyUrl: 'https://www.example.com/notify',
  returnUrl: 'https://www.example.com/return',
  paymentMethod: 'wechat',
  expireTime: 30,
};

client.createOrder(params)
  .then(result => {
    console.log(result);
  })
  .catch(error => {
    console.error(error);
  });
```

#### æŸ¥è¯¢è®¢å•

```javascript
client.queryOrder({ outTradeNo: '202401230001' })
  .then(result => {
    console.log(result);
  })
  .catch(error => {
    console.error(error);
  });
```

## æœ€ä½³å®è·µ

### å®‰å…¨å»ºè®®

1. **ä¿æŠ¤å•†æˆ·å¯†é’¥**ï¼šå•†æˆ·å¯†é’¥æ˜¯ç­¾åéªŒè¯çš„å…³é”®ï¼Œè¯·å¦¥å–„ä¿ç®¡ï¼Œä¸è¦æ³„éœ²
2. **éªŒè¯é€šçŸ¥ç­¾å**ï¼šæ¥æ”¶é€šçŸ¥æ—¶ï¼ŒåŠ¡å¿…éªŒè¯ç­¾åï¼Œé˜²æ­¢ä¼ªé€ é€šçŸ¥
3. **ä½¿ç”¨ HTTPS**ï¼šæ‰€æœ‰ API è¯·æ±‚å’Œé€šçŸ¥éƒ½åº”ä½¿ç”¨ HTTPS åŠ å¯†ä¼ è¾“
4. **è®¾ç½® IP ç™½åå•**ï¼šåœ¨å•†æˆ·åå°è®¾ç½® API è°ƒç”¨çš„ IP ç™½åå•
5. **å®šæœŸæ›´æ¢å¯†é’¥**ï¼šå»ºè®®å®šæœŸæ›´æ¢å•†æˆ·å¯†é’¥ï¼Œæé«˜å®‰å…¨æ€§

### å¼€å‘å»ºè®®

1. **ä½¿ç”¨ SDK**ï¼šæ¨èä½¿ç”¨å®˜æ–¹æä¾›çš„ SDKï¼Œç®€åŒ–å¼€å‘æµç¨‹
2. **å¤„ç†é‡å¤é€šçŸ¥**ï¼šæ”¯ä»˜é€šçŸ¥å¯èƒ½ä¼šé‡å¤å‘é€ï¼Œå•†æˆ·ç³»ç»Ÿéœ€è¦åšå¥½å¹‚ç­‰æ€§å¤„ç†
3. **æ—¥å¿—è®°å½•**ï¼šè®°å½•æ‰€æœ‰ API è¯·æ±‚å’Œé€šçŸ¥æ•°æ®ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥
4. **å¼‚å¸¸å¤„ç†**ï¼šå¦¥å–„å¤„ç† API è°ƒç”¨è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„å¼‚å¸¸æƒ…å†µ
5. **è¶…æ—¶è®¾ç½®**ï¼šè®¾ç½®åˆç†çš„è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼Œé¿å…é•¿æ—¶é—´ç­‰å¾…

### æ¥å£è°ƒç”¨é¢‘ç‡

ä¸ºäº†ä¿è¯ç³»ç»Ÿç¨³å®šæ€§ï¼ŒAPI æ¥å£æœ‰è°ƒç”¨é¢‘ç‡é™åˆ¶ï¼š

| æ¥å£ç±»å‹ | é™åˆ¶é¢‘ç‡ |
|---------|---------|
| åˆ›å»ºè®¢å• | 100æ¬¡/åˆ†é’Ÿ |
| æŸ¥è¯¢è®¢å• | 300æ¬¡/åˆ†é’Ÿ |
| å…³é—­è®¢å• | 60æ¬¡/åˆ†é’Ÿ |
| ç”³è¯·é€€æ¬¾ | 60æ¬¡/åˆ†é’Ÿ |
| æŸ¥è¯¢é€€æ¬¾ | 300æ¬¡/åˆ†é’Ÿ |

è¶…å‡ºé™åˆ¶é¢‘ç‡çš„è¯·æ±‚ä¼šè¢«æ‹’ç»ï¼Œè¿”å›é”™è¯¯ç  1005ï¼ˆè¯·æ±‚é¢‘ç‡è¶…é™ï¼‰ã€‚

## å¸¸è§é—®é¢˜

### ç­¾åéªŒè¯å¤±è´¥

å¯èƒ½åŸå› ï¼š
1. å•†æˆ·å¯†é’¥é”™è¯¯
2. å‚æ•°æ’åºä¸æ­£ç¡®
3. å‚æ•°å€¼ç¼–ç é—®é¢˜
4. ç­¾åç®—æ³•ä¸ä¸€è‡´

è§£å†³æ–¹æ³•ï¼š
1. æ£€æŸ¥å•†æˆ·å¯†é’¥æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤å‚æ•°æŒ‰ç…§ ASCII ç ä»å°åˆ°å¤§æ’åº
3. ç¡®ä¿å‚æ•°å€¼ä½¿ç”¨ UTF-8 ç¼–ç 
4. ä½¿ç”¨ MD5 ç®—æ³•å¹¶è½¬ä¸ºå¤§å†™

### è®¢å•åˆ›å»ºå¤±è´¥

å¯èƒ½åŸå› ï¼š
1. å‚æ•°ä¸å®Œæ•´æˆ–æ ¼å¼é”™è¯¯
2. å•†æˆ·è®¢å•å·é‡å¤
3. é‡‘é¢æ ¼å¼ä¸æ­£ç¡®
4. å•†æˆ·çŠ¶æ€å¼‚å¸¸

è§£å†³æ–¹æ³•ï¼š
1. æ£€æŸ¥å¿…å¡«å‚æ•°æ˜¯å¦å®Œæ•´ï¼Œæ ¼å¼æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿å•†æˆ·è®¢å•å·å”¯ä¸€
3. é‡‘é¢æ ¼å¼ä¸ºå­—ç¬¦ä¸²ï¼Œç²¾ç¡®åˆ°å°æ•°ç‚¹åä¸¤ä½
4. æ£€æŸ¥å•†æˆ·çŠ¶æ€æ˜¯å¦æ­£å¸¸

### é€šçŸ¥æ¥æ”¶é—®é¢˜

å¯èƒ½åŸå› ï¼š
1. é€šçŸ¥ URL é…ç½®é”™è¯¯
2. æœåŠ¡å™¨æ— æ³•è®¿é—®
3. å“åº”æ ¼å¼ä¸æ­£ç¡®
4. å¤„ç†è¶…æ—¶

è§£å†³æ–¹æ³•ï¼š
1. æ£€æŸ¥é€šçŸ¥ URL æ˜¯å¦æ­£ç¡®é…ç½®
2. ç¡®ä¿æœåŠ¡å™¨å¯ä»¥æ­£å¸¸è®¿é—®
3. è¿”å›æ­£ç¡®çš„å“åº”æ ¼å¼
4. ä¼˜åŒ–é€šçŸ¥å¤„ç†é€»è¾‘ï¼Œé¿å…è¶…æ—¶

## æ¥å£æ›´æ–°æ—¥å¿—

### v1.2.0 (2024-01-20)

- æ–°å¢æ‰¹é‡æŸ¥è¯¢è®¢å•æ¥å£
- æ–°å¢äº¤æ˜“ç»Ÿè®¡æ¥å£
- ä¼˜åŒ–ç­¾åç®—æ³•ï¼Œæé«˜å®‰å…¨æ€§
- ä¿®å¤éƒ¨åˆ†å·²çŸ¥é—®é¢˜

### v1.1.0 (2023-12-15)

- æ–°å¢é€€æ¬¾æ¥å£
- æ–°å¢é€€æ¬¾æŸ¥è¯¢æ¥å£
- æ–°å¢é€€æ¬¾é€šçŸ¥åŠŸèƒ½
- ä¼˜åŒ–è®¢å•æŸ¥è¯¢æ€§èƒ½

### v1.0.0 (2023-11-01)

- é¦–æ¬¡å‘å¸ƒ
- æ”¯æŒåŸºç¡€æ”¯ä»˜åŠŸèƒ½
- æä¾›è®¢å•åˆ›å»ºã€æŸ¥è¯¢ã€å…³é—­æ¥å£
- æ”¯æŒæ”¯ä»˜ç»“æœé€šçŸ¥

## è”ç³»ä¸æ”¯æŒ

å¦‚æœæ‚¨åœ¨ä½¿ç”¨ API æ¥å£è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–æ”¯æŒï¼š

1. **æŠ€æœ¯æ–‡æ¡£**ï¼šæŸ¥é˜…å®Œæ•´çš„ API æ–‡æ¡£
2. **å¼€å‘è€…ç¤¾åŒº**ï¼šåŠ å…¥å¼€å‘è€…ç¤¾åŒºï¼Œä¸å…¶ä»–å¼€å‘è€…äº¤æµ
3. **åœ¨çº¿å®¢æœ**ï¼šå·¥ä½œæ—¶é—´å†…è”ç³»åœ¨çº¿å®¢æœ
4. **é‚®ä»¶æ”¯æŒ**ï¼šå‘é€é‚®ä»¶è‡³ support@payphp.cn
5. **é—®é¢˜åé¦ˆ**ï¼šåœ¨å•†æˆ·åå°æäº¤é—®é¢˜åé¦ˆ

æˆ‘ä»¬ä¼šåœ¨æ”¶åˆ°æ‚¨çš„é—®é¢˜åï¼Œå°½å¿«ä¸ºæ‚¨è§£ç­”ã€‚
